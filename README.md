# 吉瀬研究室：研究プロジェクト

2018 3Q 後半

期限：　１０/２５（木）〜１１/１５（木）

評価基準：　面白さ（１０点満点）x 新規性（１０点満点）＝　総合評価（合計１００点満点）

用いて良いもの：

1. NEXYS4 DDR (学内にあるFPGAボード)
2. VGAディスプレイ（解像度800x600）　LCD-8000V
3. 上の二つに関連するケーブル

## FPGAボードでゲームを作ろう

### まずはVGA出力を頑張ろう

* 出力

status: complete!

同期信号が正しく出ない原因は、オーバーフローだった。
いつも、データ長のギリギリを狙っていくスタイルでボロが出てしまったみたいだ。

[11/2(金)]


* VRAM

status: needs work.

VRAMの実装は完全にでき、動作するがGitHubに落ちている、.pngから.memに
ファイルを変換するプログラムにどうやらバグがあるようだ。
これが完成しないと自分で描いた絵をゲームに使うことができないので、直したい。

[11/2(金)]


status: complete!

VRAMのインスタンスを２つ用意し、バッファーの実装をした。
その結果、描画が驚くほど綺麗になり、やっと使い物になるVGA出力の
モジュールが完成ということになった。

[11/7(水)]

### ゲームといえば、乱数生成機

status: complete!

NOTE: Implemented using "ring oscillator"
簡単にいうと、フィードバックループを作り、ハードウェアの遅延を用いることで、
真の乱数を作り出すことができるということである。

[11/5(月)]

### プレイヤーを動かそう

status: incomplete

FPGAボードのボタンを押してプレイヤーが動く実装は、完成した。
しかし、弾が打てない...。あと、ビデオ出力の実装をテストモジュールでさぼったので、
プレイヤーが通った跡が消えない。お絵描きゲームを作ってしまった。

[11/6(火)]

status: complete!

背景と敵の描画を実装したところ、うまくいくようになった。それに加えて、
ミサイルを発射するところまでできた。しかし、当たり判定に難があるようだ。

[11/7(水)]

### ゲーム完成

status: incomplete

今回BRAMを使っているが、BRAMは読み出しと書き込みを同時に行うことができるので、
そもそもバッファがいらないということを知り、バッファを消すのだが、
それを行う段階で、いろいろしょうもないところでつまずいて、進捗が思うようにはなかった。
当たり判定がおかしくて、なぜか開始０秒でプレイヤーが死ぬ。

[11/8(木)]

status: incomplete

ゲームを遊べるところまで、進めることができた。当たり判定の件については、
吉川くんのおかげで不等式を直せたのと、当たり判定を少し遅れてから始めるという工夫で
直すことができた。ワイヤーの値がまだ不定の時に、それらの値を使って
当たり判定を計算してしまっていた。

それから、自分の手書きで描いた絵にキャラクターや
背景も置き換えておいた。あとは、ちょっとした微調整だけで完成というところまできた。
直すべき点としては、

* ミサイルの当たり判定が少し左にずれていること。
* 描画に遅れが出ていて、画像が全体的に右に３ピクセルぐらいずれていること。（おそらく、あの変なv_ram_dataout_bufferなんていう余計なレジスタを消せば大丈夫なはず。
* 敵が少し硬すぎること。とりあえず、へたくそでも１分ぐらいでクリアできればいいかなと思う。
* 座標計算が雑なこと。ミサイルがプレイヤーの左端から発射されることなどなど、もう少し真面目に計算するべきだと思った。
